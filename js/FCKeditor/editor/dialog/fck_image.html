<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!--
 * FCKeditor - The text editor for Internet - http://www.fckeditor.net
 * Copyright (C) 2003-2010 Frederico Caldeira Knabben
 *
 * == BEGIN LICENSE ==
 *
 * Licensed under the terms of any of the following licenses at your
 * choice:
 *
 *  - GNU General Public License Version 2 or later (the "GPL")
 *    http://www.gnu.org/licenses/gpl.html
 *
 *  - GNU Lesser General Public License Version 2.1 or later (the "LGPL")
 *    http://www.gnu.org/licenses/lgpl.html
 *
 *  - Mozilla Public License Version 1.1 or later (the "MPL")
 *    http://www.mozilla.org/MPL/MPL-1.1.html
 *
 * == END LICENSE ==
 *
 * Image Properties dialog window.
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Image Properties</title>
	<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
	<meta name="robots" content="noindex, nofollow" />
	<script src="common/fck_dialog_common.js" type="text/javascript"></script>
	<script src="fck_image/fck_image.js" type="text/javascript"></script>
		<script type="text/javascript">

document.write( FCKTools.GetStyleHtml( GetCommonDialogCss() ) ) ;

		</script>
<script src="/jquery-1.3.2/jquery-1.4.2.min.js"  type="text/javascript"></script>
<script src="/includes/javascript/zip_upload/swfobject.js" type="text/javascript"></script>
<style type="text/css">
/* 图片压缩上传相关 */
.photoUploading .selected { background: url("/image/icons/clear.gif") repeat scroll 0 0 transparent; }
.photoUploading ul { max-height: 200px; overflow-x: hidden; overflow-y: auto; padding-left:0px }
.photoUploading li { border-bottom: 1px dashed #DBDBDB; float: left; height: 28px; line-height: 28px; overflow: hidden; padding: 1px 0; position: relative; width: 390px; }
.photoUploading .succeed { background: url("/image/icons/upload_succeed.gif") repeat scroll 0 0 transparent; cursor: pointer; display: inline; height: 15px; left: 230px; margin: 6px 0 0 25px; position: absolute; top: 1px; width: 15px; }
.photoUploading .del { background: url("/image/icons/icon_del_red.gif") no-repeat scroll center center transparent; cursor: pointer; display: inline; height: 15px; left: 430px; margin: 7px 0 0 25px; position: absolute; top: 1px; width: 15px; }
.photoUploading .name { left: 0; padding-left: 10px; position: absolute; top: 1px; width: 340px; }
.photoUploading .name a { color: #327EF6; margin-left: 15px; }
.photoUploading .size { left: 340px; position: absolute; text-align: right; top: 1px; width: 90px; }
.photoUploading .status { background-repeat: no-repeat !important; cursor: pointer; display: inline; float: left; height: 15px; left: 330px; line-height: 18px; margin: 6px 0 0 25px; padding-top: 8px; position: absolute; top: 1px; width: 15px; }
.photoUploading .selected { background: url("/image/icons/clear.gif") repeat scroll 0 0 transparent; }
.photoUploading .loading { background: url("/image/icons/loading.gif") repeat scroll 0 0 transparent; }
.photoUploading .uploaded { background: url("/image/icons/upload_succeed.gif") repeat scroll 0 0 transparent; }
.photoUploading .notUpload { background: url("/image/icons/icon_del_red.gif") repeat scroll 0 0 transparent; }
.photoUploading .count { background: none repeat scroll 0 0 #EDEDED; border: 0 none; margin-top: -1px; }
.photoUploading .process { background: none repeat scroll 0 0 #F5FAE4; border-right: 4px solid #B1D54D; height: 28px; }
.photoUploading .allstatus { float: left; line-height: 18px; padding-top: 8px; width: 490px; }
.photoUploading .processBar { border: 1px solid #D6D6D6; display: inline; float: left; height: 18px; margin-right: 3px; width: 460px; }
.photoUploading .barCon { background: none repeat scroll 0 0 #9ABE36; height: 18px; }
.photoUploading .wait { background: url("/image/icons/loading.gif") no-repeat scroll 160px center transparent; float: left; font-weight: bold; line-height: 20px; margin-top: 12px; text-align: center; width: 490px; }
.photoUploading .suc { background: url("/image/icons/upload_succeed.gif") no-repeat scroll 96px center transparent; clear: both; font-weight: bold; line-height: 30px; text-align: center; }
.photoUploading .suc a { color: #327EF6; font-size: 14px; margin-left: 12px; }
.photoUploading .btnCenter { padding: 12px 0; }
.photoUpload { margin-bottom: 10px; overflow: hidden; width: 743px; }
.photoUpload li { float: left; overflow: hidden; padding: 20px 0; width: 370px; }
.photoUpload li .pic { background: none repeat scroll 0 0 #FCFCFC; border: 1px solid #F0F0F0; height: 188px; margin: 0 auto; width: 250px; }
.photoUpload li .pic a { display: table-cell; height: 188px; text-align: center; vertical-align: middle; width: 250px; }
.photoUpload li .pic img { max-height: 188px; max-width: 250px; vertical-align: middle; }
.btnOrange {
    width: 80px;
}
a {
blr: expression(this.onFocus=this.blur());
word-wrap: break-word;
}

a {
color: rgb(0, 56, 138);
text-decoration: none;
}

a:-webkit-any-link {
color: -webkit-link;
text-decoration: underline;
cursor: auto;
}

.btnOrange {
    background: url("/image/button_bg.gif") repeat scroll 0 0 transparent;
    border: 1px solid #F8B709;
    font-weight: bold;
}

.btn {
	text-align:center;
    cursor: pointer;
    display: inline-block;
    height: 23px;
    line-height: 23px;
    overflow: hidden;
    white-space: nowrap;
}

.btnGrey {
width: 80px;
}

.btnGrey {
width: auto;
background: url(/image/button_bg.gif) 0px -46px;
border: 1px solid rgb(228, 228, 228);
}

.btn {
display: inline-block;
height: 23px;
white-space: nowrap;
overflow: hidden;
line-height: 23px;
cursor: pointer;
}



</style>
<script type="text/javascript">
        var eAddPhoto;
        var eAppendPhoto;
        var jPhotoList;
        var jProcess;
        var allSize = 0;
        var doneCount = 0;
        var infos = [];
        var isInited = false;
        function showFlash() {
			jPhotoList = jQuery("#ulPhotoList");
            //alert(jQuery("#ulPhotoList").html());			
            jSelect = jQuery("#divSelect");
            jProcess = jQuery("#divProcess");
            jDone = jQuery("#divDone");
			
            var vars = {
                serverUrl: "/ajax_upload_talentuserfile.php",
                jsUpdateInfo: "jsUpdateInfo",
                imgWidth: 750,
                imgHeight: 750,
                imgQuality: 80
            }
            var vars1 = vars;
            vars1.flashID = "divAddPhoto";
            vars1.labelColor = "#00388A";
            vars1.labelText = "浏览";
            vars1.hasUnderLine = false;
            swfobject.embedSWF("/includes/javascript/zip_upload/PhotoUploader.swf", "divAddPhoto", "80", "25", "10.0.0", "/includes/javascript/zip_upload/expressInstall.swf", vars1, { wmode: "Transparent" });                       

        }
		function jsUpdateInfo(flashID, name, status, size, message) {
			//alert(status);
			//alert(message);
            var index = (status == "selected" ? infos.length : getIndexByName(name));
            if (status == "selected") {
                infos=[];
				if (infos.length == 0) {
                    
                    allSize = 0;
                    //doneCount = 0;
                    jPhotoList.children().remove();
                    //showPopup('popupUpload_Load', 'popupConUpload');                    
                    //jDone.hide();
                    jSelect.show();
                    jQuery("#divAppendPhoto").height(20);
                }
                if (getIndexByName(name) >= 0) {
                    alert(name + "已存在!");
                    return;
                }
                
				if(infos.length >= 1){
                    //alert("<?php echo db_to_html("一次只能上传100张!");?>");
                    return;
				}else{
                    
					infos.push({
						name: name,
						flashID: flashID,
						title: name.substr(0, name.lastIndexOf(".")),
						status: status
					});
                    
                    jPhotoList = jQuery("#ulPhotoList");                 
                    
					jPhotoList.append('<li><div class="name">' + name + '</div><div class="status ' + status + '"></div><div class="process" style="width:0%;"></div></li>');
				 
                   jQuery(".selected",jQuery("li:nth-child(" + infos.length + ")",jPhotoList)).click(function() {
						swfobject.getObjectById(flashID).Remove(name);
					});
                 	
					allSize += size;					
				}
            } else {
                var jPhoto = jQuery("li:nth-child(" + (index + 1) + ")", jPhotoList);
                var jSize = jQuery("div.size", jPhoto);
                var jStatus = jQuery(".status", jPhoto);
                var jProgress = jQuery(".process", jPhoto);
                infos[index].status = status;
                
                if (status == "void") {
                    jPhoto.remove();
                    allSize -= size;
                    var temp = [];
                    for (i = 0; i < infos.length; i++) {
                        if (infos[i].name != name) {
                            temp.push(infos[i]);
                        }
                    }
                    infos = temp;
                    updateSummary();
                } else {
                    jStatus.removeClass();
                    jStatus.addClass("status " + status);
					
					switch (status) {
                        case "loading":
                            jProgress.width(message);
                            break;
                        case "loaded":
                            jSize.text(formatSize(size));
                            break;
                        case "notLoad":
                            alert(message);
                            break;
                        case "uploaded":
							
							if(message=="0"){
								alert('上传失败，请重新上传!:upload faild');
                                infos=[];
							}else{	
								var tmp_array = message.split('|');
								
								if(tmp_array[0]=="1"){
									//tmp_array[1];	//返回的文件路径
									OnUploadCompleted(0, tmp_array[1], tmp_array[1], '');
									Ok();
									//jQuery("#btnOk").attr('style','');
									//jQuery("#divUpload").hide();
									//jQuery("#divInfo").show();
									//jQuery("#txtUrl").val(''+tmp_array[1]+'');
									//jQuery(".ImagePreviewArea").val(tmp_array[4]);
									jQuery(".selected",jQuery("li:nth-child(" + infos.length + ")",jPhotoList)).click(function() {
										swfobject.getObjectById(flashID).Remove(name);
									});
									infos=[];
								}						
								
							}							
                            break;
                        case "notUpload":
							
                            
							jProgress.width("100%");
                            ++doneCount;
                            updateProgress();
                            alert(message);
                            upload();
                            break;
							
							
                    }
                }
            }
        }
		
		function formatSize(size) {
            if (size > 1024 * 1024) {
                return Math.round(size * 100 / (1024 * 1024)) / 100 + "MB";
            } else {
                return Math.floor(size / 1024) + "KB";
            }
        }
        function updateProgress() {
            var allPersent = Math.floor(doneCount * 100 / infos.length) + "%";
            jQuery("div:nth-child(1) div:only-child", jProcess).width(allPersent);
            jQuery("span:nth-child(2)", jProcess).text(allPersent);
        }
        function updateSummary() {
            jQuery("#txtPhotoCount").text(infos.length);
            jQuery("#txtAllSize").text(formatSize(allSize));
        }
        function getIndexByName(name) {
            for (var i = 0; i < infos.length; i++) {
                if (infos[i].name == name) {
                    return i;
                }
            }
            return -1;
        }
		
		function upload() {
            if (infos.length == 0 ) {
                alert("请先选择照片");
                return;
            }
         
            //
            /*点击上传时将*/
					
            var index;
            for (var i = 0; i < infos.length; i++) {
                var info = infos[i];
                if (info.status == "selected") {
                    index = i;
                    break;
                }
            }
            //
            if (doneCount == 0) {
                jQuery("#divAppendPhoto").height(0);
                updateProgress();
                jSelect.hide();
                jProcess.show();
            }			
            jQuery(".selected", jQuery("li:nth-child(" + (infos+1) + ")", jPhotoList)).unbind("click");
            swfobject.getObjectById(infos[index].flashID).Load(infos[index].name);
			
        }
</script>	
</head>
<body scroll="no" style="overflow: hidden" onLoad="showFlash()">
	<div id="divUpload">
		<a id="ALinkAddPhoto"  class="btn btnGrey" href="javascript:void(0)"><div id="divAddPhoto">loading...</div></a>
		<div class="photoUploading"><ul id="ulPhotoList"></ul></div>
		<a href="javascript:" class="btn btnOrange" onClick="upload();">上传</a>
		
		<!--<form id="frmUpload" method="post" target="UploadWindow" enctype="multipart/form-data"
			action="" onSubmit="return CheckUpload();">
			<span fcklang="DlgLnkUpload">Upload</span><br />
			<input id="txtUploadFile" style="width: 100%" type="file" size="40" name="NewFile" /><br />
			<br />
			<input id="btnUpload" type="submit" value="Send it to the Server" fcklang="DlgLnkBtnUpload" />
			<script type="text/javascript">
				document.write( '<iframe name="UploadWindow" style="display: none" src="' + FCKTools.GetVoidUrl() + '"><\/iframe>' ) ;
			</script>
		</form>-->
		
		
	</div>
	<div id="divInfo"  style="display: none">
		<table cellspacing="1" cellpadding="1" border="0" width="100%" height="100%">
			<tr>
				<td>
					<table cellspacing="0" cellpadding="0" width="100%" border="0">
						<tr>
                        
							<td width="100%">
								<span fcklang="DlgImgURL">URL</span>
							</td>
                        
							<td id="tdBrowse" style="display: none" nowrap="nowrap" rowspan="2">
								<!--&nbsp;
								<input id="btnBrowse" onclick="BrowseServer();" type="button" value="Browse Server"
									fcklang="DlgBtnBrowseServer" />-->
							</td>
						</tr>
						<tr>
							<td valign="top">
								<input id="txtUrl" style="width: 100%" type="text" onBlur="UpdatePreview();" />
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td>
					<span fcklang="DlgImgAlt">Short Description</span><br />
					<input id="txtAlt" style="width: 100%" type="text" /><br />
				</td>
			</tr>
			<tr height="100%">
				<td valign="top">
					<table cellspacing="0" cellpadding="0" width="100%" border="0" height="100%">
						<tr>
							<td valign="top">
								<br />
								<table cellspacing="0" cellpadding="0" border="0">
									<tr>
										<td nowrap="nowrap">
											<span fcklang="DlgImgWidth">Width</span>&nbsp;</td>
										<td>
											<input type="text" size="3" id="txtWidth" onKeyUp="OnSizeChanged('Width',this.value);" /></td>
										<td rowspan="2">
											<div id="btnLockSizes" class="BtnLocked" onMouseOver="this.className = (bLockRatio ? 'BtnLocked' : 'BtnUnlocked' ) + ' BtnOver';"
												onmouseout="this.className = (bLockRatio ? 'BtnLocked' : 'BtnUnlocked' );" title="Lock Sizes"
												onclick="SwitchLock(this);">
											</div>
										</td>
										<td rowspan="2">
											<div id="btnResetSize" class="BtnReset" onMouseOver="this.className='BtnReset BtnOver';"
												onmouseout="this.className='BtnReset';" title="Reset Size" onClick="ResetSizes();">
											</div>
										</td>
									</tr>
									<tr>
										<td nowrap="nowrap">
											<span fcklang="DlgImgHeight">Height</span>&nbsp;</td>
										<td>
											<input type="text" size="3" id="txtHeight" onKeyUp="OnSizeChanged('Height',this.value);" /></td>
									</tr>
								</table>
								<br />
								<table cellspacing="0" cellpadding="0" border="0">
									<tr>
										<td nowrap="nowrap">
											<span fcklang="DlgImgBorder">Border</span>&nbsp;</td>
										<td>
											<input type="text" size="2" value="" id="txtBorder" onKeyUp="UpdatePreview();" /></td>
									</tr>
									<tr>
										<td nowrap="nowrap">
											<span fcklang="DlgImgHSpace">HSpace</span>&nbsp;</td>
										<td>
											<input type="text" size="2" id="txtHSpace" onKeyUp="UpdatePreview();" /></td>
									</tr>
									<tr>
										<td nowrap="nowrap">
											<span fcklang="DlgImgVSpace">VSpace</span>&nbsp;</td>
										<td>
											<input type="text" size="2" id="txtVSpace" onKeyUp="UpdatePreview();" /></td>
									</tr>
									<tr>
										<td nowrap="nowrap">
											<span fcklang="DlgImgAlign">Align</span>&nbsp;</td>
										<td>
											<select id="cmbAlign" onChange="UpdatePreview();">
												<option value="" selected="selected"></option>
												<option fcklang="DlgImgAlignLeft" value="left">Left</option>
												<option fcklang="DlgImgAlignAbsBottom" value="absBottom">Abs Bottom</option>
												<option fcklang="DlgImgAlignAbsMiddle" value="absMiddle">Abs Middle</option>
												<option fcklang="DlgImgAlignBaseline" value="baseline">Baseline</option>
												<option fcklang="DlgImgAlignBottom" value="bottom">Bottom</option>
												<option fcklang="DlgImgAlignMiddle" value="middle">Middle</option>
												<option fcklang="DlgImgAlignRight" value="right">Right</option>
												<option fcklang="DlgImgAlignTextTop" value="textTop">Text Top</option>
												<option fcklang="DlgImgAlignTop" value="top">Top</option>
											</select>
										</td>
									</tr>
								</table>
							</td>
							<td>
								&nbsp;&nbsp;&nbsp;</td>
							<td width="100%" valign="top">
								<table cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed">
									<tr>
										<td>
											<span fcklang="DlgImgPreview">Preview</span></td>
									</tr>
									<tr>
										<td valign="top">
											<iframe class="ImagePreviewArea" src="fck_image/fck_image_preview.html" frameborder="0"
												marginheight="0" marginwidth="0"></iframe>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</div>

    
	<div id="divLink" style="display: none">
        
		<table cellspacing="1" cellpadding="1" border="0" width="100%" style="display: none">
			<tr>
				<td>
					<div>
						<span fcklang="DlgLnkURL">URL</span><br />
						<input id="txtLnkUrl" style="width: 100%" type="text" onBlur="UpdatePreview();" />
					</div>
					<div id="divLnkBrowseServer" align="right">
						<input type="button" value="Browse Server" fcklang="DlgBtnBrowseServer" onClick="LnkBrowseServer();" />
					</div>
					<div>
						<span fcklang="DlgLnkTarget">Target</span><br />
						<select id="cmbLnkTarget">
							<option value="" fcklang="DlgGenNotSet" selected="selected">&lt;not set&gt;</option>
							<option value="_blank" fcklang="DlgLnkTargetBlank">New Window (_blank)</option>
							<option value="_top" fcklang="DlgLnkTargetTop">Topmost Window (_top)</option>
							<option value="_self" fcklang="DlgLnkTargetSelf">Same Window (_self)</option>
							<option value="_parent" fcklang="DlgLnkTargetParent">Parent Window (_parent)</option>
						</select>
					</div>
				</td>
			</tr>
		</table>
        
	</div>
  
	<div id="divAdvanced" style="display: none">
       
		<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0" style="display: none">
			<tr>
				<td valign="top" width="50%">
					<span fcklang="DlgGenId">Id</span><br />
					<input id="txtAttId" style="width: 100%" type="text" />
				</td>
				<td width="1">
					&nbsp;&nbsp;</td>
				<td valign="top">
					<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
						<tr>
							<td width="60%">
								<span fcklang="DlgGenLangDir">Language Direction</span><br />
								<select id="cmbAttLangDir" style="width: 100%">
									<option value="" fcklang="DlgGenNotSet" selected="selected">&lt;not set&gt;</option>
									<option value="ltr" fcklang="DlgGenLangDirLtr">Left to Right (LTR)</option>
									<option value="rtl" fcklang="DlgGenLangDirRtl">Right to Left (RTL)</option>
								</select>
							</td>
							<td width="1%">
								&nbsp;&nbsp;</td>
							<td nowrap="nowrap">
								<span fcklang="DlgGenLangCode">Language Code</span><br />
								<input id="txtAttLangCode" style="width: 100%" type="text" />&nbsp;
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;
					</td>
			</tr>
			<tr>
				<td colspan="3">
					<span fcklang="DlgGenLongDescr">Long Description URL</span><br />
					<input id="txtLongDesc" style="width: 100%" type="text" />
				</td>
			</tr>
			<tr>
				<td colspan="3">&nbsp;
					</td>
			</tr>
			<tr>
				<td valign="top">
					<span fcklang="DlgGenClass">Stylesheet Classes</span><br />
					<input id="txtAttClasses" style="width: 100%" type="text" />
				</td>
				<td>
				</td>
				<td valign="top">
					&nbsp;<span fcklang="DlgGenTitle">Advisory Title</span><br />
					<input id="txtAttTitle" style="width: 100%" type="text" />
				</td>
			</tr>
		</table>
		<span fcklang="DlgGenStyle">Style</span><br />
		<input id="txtAttStyle" style="width: 100%" type="text" />
        
	</div>
</body>
</html>
